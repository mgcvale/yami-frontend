var ra=(n,a,v)=>new Promise((m,d)=>{var r=c=>{try{h(v.next(c))}catch(R){d(R)}},i=c=>{try{h(v.throw(c))}catch(R){d(R)}},h=c=>c.done?m(c.value):Promise.resolve(c.value).then(r,i);h((v=v.apply(n,a)).next())});import{e as ca}from"../chunks/C3_eTjx-.js";import{D as $}from"../chunks/D4ODo2ld.js";import{e as xa,f as wa,c as Z,a as ua,g as q,s as Sa,b as ea,d as ta}from"../chunks/tpmtnrJv.js";import{i as Ra}from"../chunks/BtRaPuvF.js";import{i as ja}from"../chunks/CqBOX26c.js";import{h as ka}from"../chunks/Dx98FtbP.js";import"../chunks/COm6N4YE.js";import{p as sa,f as l,d as s,r as t,s as w,l as S,m as ia,t as G,b as e,c as oa,o as X,k as Da,h as K,a as M,O as ya,n as Ia}from"../chunks/FcNz6uVe.js";import{i as u}from"../chunks/7ms9Oyq9.js";import{a as ma,b as ga,p as Fa}from"../chunks/BdHP4ea0.js";import{p as Oa}from"../chunks/DUEo-2bu.js";import{c as ba}from"../chunks/BWmCwwzs.js";import"../chunks/BQspDZ5E.js";import"../chunks/vsAJmYaO.js";import{s as ha}from"../chunks/Cb4E-4CT.js";import{s as T,o as Pa}from"../chunks/CQT1G1Sl.js";import{d as Ea,e as Aa,f as Ca}from"../chunks/BsEKk5dv.js";import{R as Ta}from"../chunks/Bg0mXhfR.js";import{g as la}from"../chunks/QXgKwo3K.js";import{I as Ua}from"../chunks/BtsYN2KJ.js";import"../chunks/BlMnf9v-.js";import{i as La}from"../chunks/R6t93NzD.js";import{i as Ba}from"../chunks/B6FbEGtQ.js";import{D as pa}from"../chunks/CUUdhvzw.js";import{g as Ma,s as za}from"../chunks/Cy75KbwB.js";import{U as Ya}from"../chunks/BL5N-FMU.js";function Ja(n,a=0){return ra(this,null,function*(){try{let v=yield xa(yield wa(Z.apiPaths.userFeed(a),{headers:{Authorization:`Bearer ${n}`}},Z.fetchTimeout));if(console.log(v),!ja(v,Ra))throw $.BAD_RESPONSE;return ua(v)}catch(v){return ka(v)}})}const Wa=n=>ra(null,null,function*(){const{parent:a,depends:v}=n,{user:m}=yield a();if(!m)throw ca(401,$.USER_NOT_LOADED);let d=yield Ja(m.accessToken,0);if(d.error)throw ca(d.error.status,d.error);if(!d.data)throw ca($.BAD_RESPONSE.status,$.BAD_RESPONSE);return{user:m,feedEntries:d.data.content}}),oe=Object.freeze(Object.defineProperty({__proto__:null,load:Wa},Symbol.toStringTag,{value:"Module"}));var qa=(n,a)=>{n.preventDefault(),la(`/app/user?id=${a.review.userId}`)},Ga=(n,a)=>{n.preventDefault(),la(`/app/user?id=${a.review.userId}`)},Ha=(n,a)=>{n.preventDefault(),la(`/app/food?id=${a.review.foodId}`)},Ka=(n,a)=>{n.preventDefault(),la(`/app/restaurant?id=${a.review.restaurantId}`)},Qa=l('<img class="w-full h-full object-cover"/>'),Va=l('<div class="bg-light-card-1 dark:bg-dark-card-1 rounded-xl overflow-hidden shadow-sm p-4 flex flex-col gap-3 min-w-full"><div class="flex items-center justify-between"><div class="flex items-center gap-3"><a><img src="https://static.vecteezy.com/system/resources/previews/009/292/244/non_2x/default-avatar-icon-of-social-media-user-vector.jpg" class="w-10 h-10 rounded-full object-cover"/></a> <a class="font-semibold text-light-fg-900 dark:text-dark-fg-100 hover:underline"> </a></div> <!></div> <div class="flex flex-col"><a class="font-semibold text-light-fg-900 dark:text-dark-fg-100 hover:underline text-md"> </a> <a class="text-light-fg-500 dark:text-dark-fg-500 text-sm hover:underline"> </a></div> <div class="flex gap-4"><div class="w-32 h-32 bg-gray-200 dark:bg-gray-700 flex items-center justify-center rounded-md overflow-hidden shrink-0"><!></div> <div class="flex flex-col justify-start grow"><p class="text-light-fg-700 dark:text-dark-fg-300 text-sm"> </p></div></div></div>');function Xa(n,a){sa(a,!0);let v=ia(!1);var m=Va(),d=s(m),r=s(d),i=s(r);i.__click=[qa,a];var h=s(i);t(i);var c=w(i,2);c.__click=[Ga,a];var R=s(c,!0);t(c),t(r);var p=w(r,2);Ta(p,{get rating(){return a.review.rating}}),t(d);var O=w(d,2),x=s(O);x.__click=[Ha,a];var g=s(x);t(x);var j=w(x,2);j.__click=[Ka,a];var U=s(j,!0);t(j),t(O);var z=w(O,2),P=s(z),_=s(P);{var D=I=>{var A=Qa();G(f=>{q(A,"src",f),q(A,"alt",a.review.foodName)},[()=>Z.apiPaths.foodImage(a.review.foodId)]),Aa("error",A,()=>{X(v,!0)}),Ca(A),e(I,A)},k=I=>{Ua(I,{class:"w-8 h-8 text-light-fg-400 dark:text-dark-fg-400"})};u(_,I=>{S(v)?I(k,!1):I(D)})}t(P);var Y=w(P,2),o=s(Y),y=s(o,!0);t(o),t(Y),t(z),t(m),G(()=>{var I,A;q(i,"href",`/app/user?id=${a.review.userId}`),q(h,"alt",`${(I=a.review.username)!=null?I:""}'s avatar`),q(c,"href",`/app/user?id=${a.review.userId}`),T(R,a.review.username),q(x,"href",`/app/food?id=${a.review.foodId}`),T(g,`${(A=a.review.foodName)!=null?A:""} review`),q(j,"href",`/app/restaurant?id=${a.review.restaurantId}`),T(U,a.review.restaurantName),T(y,a.review.review)}),e(n,m),oa()}Ea(["click"]);function Za(n){return ra(this,null,function*(){try{const a=yield xa(yield wa(Z.apiPaths.restaurantReccomendations(),{headers:{Authorization:`Bearer ${n}`}},Z.fetchTimeout));if(console.log(a),!Ba(a,La))throw $.BAD_RESPONSE;return ua(a)}catch(a){return ka(a)}})}var $a=l("<p>Loading your recommendations...</p>"),ar=l('<p class="fg-light-error dark:fg-dark-error"> </p>'),rr=l("<p>No restaurant recommendations were found for you!</p>"),er=l('<a class="h-full w-full"><div class="p-4 flex flex-col items-center justify-start bg-light-card-1 dark:bg-dark-card-1 rounded-xl shadow-xs h-full w-full"><h3 class="font-alegreya text-xl"> </h3> <h4 class="text-xs"> </h4> <img class="h-20 rounded-full w-auto"/></div></a>'),tr=l('<div class="grid auto-cols-[minmax(12rem,1fr)] grid-flow-col gap-4 p-4 px-0 pb-0 w-full overflow-x-auto"><!></div>'),sr=l('<section class="flex flex-col items-start justify-start w-full"><!> <h3 class="font-alegreya text-2xl">Restaurant recommendations</h3> <p class="text-sm">Based on what your friends have been reviewing</p> <!> <!></section>');function or(n,a){sa(a,!0);const[v,m]=ga(),d=()=>ma(ba,"$currentUserStore",v);let r=ia(!0),i=ia(Da(ua([])));Pa(()=>ra(null,null,function*(){if(X(r,!0),!d().data){X(r,!1),X(i,Sa($.USER_NOT_LOADED),!0);return}X(i,yield Za(d().data.accessToken),!0),X(r,!1)}));var h=sr(),c=s(h);pa(c,{lineClassName:"bg-light-card-2 dark:bg-dark-card-2",containerClassName:"px-4 py-2"});var R=w(c,6);{var p=g=>{var j=$a();e(g,j)},O=g=>{var j=tr(),U=s(j);{var z=_=>{var D=ar(),k=s(D,!0);t(D),G(()=>T(k,S(i).error.message)),e(_,D)},P=(_,D)=>{{var k=o=>{var y=rr();e(o,y)},Y=o=>{var y=K(),I=M(y);ea(I,17,()=>S(i).data,ta,(A,f)=>{var b=er(),H=s(b),L=s(H),E=s(L,!0);t(L);var F=w(L,2),J=s(F,!0);t(F);var N=w(F,2);t(H),t(b),G(B=>{var W,V;q(b,"href",`/restaurant?id=${(W=S(f).id)!=null?W:""}`),T(E,S(f).shortName),T(J,S(f).name),q(N,"src",B),q(N,"alt",`${(V=S(f).shortName)!=null?V:""}'s photo`)},[()=>Z.apiPaths.restaurantImage(S(f).id)]),e(A,b)}),e(o,y)};u(_,o=>{S(i).data==null||S(i).data.length==0?o(k):o(Y,!1)},D)}};u(U,_=>{S(i).error!==null?_(z):_(P,!1)})}t(j),e(g,j)};u(R,g=>{S(r)?g(p):g(O,!1)})}var x=w(R,2);pa(x,{lineClassName:"bg-light-card-2 dark:bg-dark-card-2",containerClassName:"px-4 pt-4"}),t(h),e(n,h),oa(),m()}var lr=l("<!> <!>",1),ir=l('<div><h1 class="font-alegreya text-3xl">Your feed</h1> <div></div></div>');function nr(n,a){let v=Fa(a,"className",3,"");var m=ir(),d=w(s(m),2);ea(d,21,()=>a.content,ta,(r,i,h)=>{var c=lr(),R=M(c);Xa(R,{get review(){return S(i)}});var p=w(R,2);{var O=x=>{or(x,{})};u(p,x=>{h==6&&x(O)})}e(r,c)}),t(d),t(m),G(()=>{var r,i;ha(m,1,`flex flex-col justify-start items-start p-4 gap-2 ${(r=v())!=null?r:""}`),ha(d,1,`flex flex-col w-full h-fit justify-start items-center gap-4 ${(i=v())!=null?i:""}`)}),e(n,m)}var vr=(n,a)=>{la(`/app/restaurant?id=${a.restaurant.id}`)},dr=l('<button class="w-full h-fit bg-light-card-2 hover:bg-light-card-3 dark:hover:bg-dark-card-2 active:bg-light-card-3 dark:active:bg-dark-card-2 dark:bg-dark-card-1 p-2 px-4 items-start flex flex-col gap-2 jutsify-start rounded-2xl cursor-pointer"><div class="flex justify-start items-center gap-2 h-10 pt-1"><img class="h-full w-auto block rounded-full" alt="restaurant"/> <h3 class="text-lg"> </h3> <span class="text-sm text-light-fg-700 dark:text-dark-fg-700"><span> </span></span></div> <p class="text-start text-sm text-light-fg-700 dark:text-dark-fg-700"> </p></button>');function fr(n,a){sa(a,!0);var v=dr();v.__click=[vr,a];var m=s(v),d=s(m),r=w(d,2),i=s(r,!0);t(r);var h=w(r,2),c=s(h),R=s(c,!0);t(c),t(h),t(m);var p=w(m,2),O=s(p,!0);t(p),t(v),G(x=>{q(d,"src",x),T(i,a.restaurant.shortName),T(R,a.restaurant.name),T(O,a.restaurant.description)},[()=>Z.apiPaths.restaurantImage(a.restaurant.id)]),e(n,v),oa()}Ea(["click"]);var cr=l("<p>Loading...</p>"),ur=l("<p>Make a search to view results!</p>"),mr=l("<p> </p>"),gr=l("<h2>No restaurants were found!</h2>"),_r=l("<h2>Found restaurants:</h2> <!>",1),hr=l("<p>Loading...</p>"),pr=l("<p>Make a search to view results!</p>"),xr=l("<p> </p>"),wr=l("<h2>No foods were found!</h2>"),kr=l("<div> </div>"),yr=l("<h2>Found foods:</h2> <!>",1),br=l("<p>Loading...</p>"),Er=l("<p>Make a search to view results!</p>"),Nr=l("<p> </p>"),Sr=l("<h2>No users were found!</h2>"),Rr=l("<h2>Found users:</h2> <!>",1),jr=l('<div class="flex flex-col justify-start items-start p-4 gap-2"><div class="flex justify-between items-center w-full pb-4"><h1 class="font-alegreya text-2.5xl"> </h1></div> <!></div>');function Dr(n,a){sa(a,!0);const[v,m]=ga(),d=()=>ma(za,"$searchingFor",v),r=Ma();ya(()=>{r.results});var i=jr(),h=s(i),c=s(h),R=s(c);t(c),t(h);var p=w(h,2);{var O=g=>{var j=K(),U=M(j);{var z=_=>{var D=cr();e(_,D)},P=(_,D)=>{{var k=o=>{var y=ur();e(o,y)},Y=(o,y)=>{{var I=f=>{var b=mr(),H=s(b);t(b),G(()=>{var L;return T(H,`Error: ${(L=r.results.restaurants.error.message)!=null?L:""}`)}),e(f,b)},A=(f,b)=>{{var H=L=>{var E=K(),F=M(E);{var J=B=>{var W=gr();e(B,W)},N=B=>{var W=_r(),V=w(M(W),2);ea(V,17,()=>r.results.restaurants.data.content,ta,(aa,C)=>{fr(aa,{get restaurant(){return S(C)}})}),e(B,W)};u(F,B=>{r.results.restaurants.data.content.length==0?B(J):B(N,!1)})}e(L,E)};u(f,L=>{r.results.restaurants.data!==null&&L(H)},b)}};u(o,f=>{r.results.restaurants.error!==null?f(I):f(A,!1)},y)}};u(_,o=>{r.results.restaurants===null?o(k):o(Y,!1)},D)}};u(U,_=>{r.loading?_(z):_(P,!1)})}e(g,j)},x=(g,j)=>{{var U=P=>{var _=K(),D=M(_);{var k=o=>{var y=hr();e(o,y)},Y=(o,y)=>{{var I=f=>{var b=pr();e(f,b)},A=(f,b)=>{{var H=E=>{var F=xr(),J=s(F);t(F),G(()=>{var N;return T(J,`Error: ${(N=r.results.foods.error.message)!=null?N:""}`)}),e(E,F)},L=(E,F)=>{{var J=N=>{var B=K(),W=M(B);{var V=C=>{var Q=wr();e(C,Q)},aa=C=>{var Q=yr(),na=w(M(Q),2);ea(na,17,()=>r.results.foods.data.content,ta,(va,da)=>{var fa=kr(),Na=s(fa);t(fa),G(()=>{var _a;return T(Na,`Food: ${(_a=S(da).name)!=null?_a:""}`)}),e(va,fa)}),e(C,Q)};u(W,C=>{r.results.foods.data.content.length==0?C(V):C(aa,!1)})}e(N,B)};u(E,N=>{r.results.foods.data!==null&&N(J)},F)}};u(f,E=>{r.results.foods.error!==null?E(H):E(L,!1)},b)}};u(o,f=>{r.results.foods===null?f(I):f(A,!1)},y)}};u(D,o=>{r.loading?o(k):o(Y,!1)})}e(P,_)},z=P=>{var _=K(),D=M(_);{var k=o=>{var y=br();e(o,y)},Y=(o,y)=>{{var I=f=>{var b=Er();e(f,b)},A=(f,b)=>{{var H=E=>{var F=Nr(),J=s(F);t(F),G(()=>{var N;return T(J,`Error: ${(N=r.results.users.error.message)!=null?N:""}`)}),e(E,F)},L=(E,F)=>{{var J=N=>{var B=K(),W=M(B);{var V=C=>{var Q=Sr();e(C,Q)},aa=C=>{var Q=Rr(),na=w(M(Q),2);ea(na,17,()=>r.results.users.data.content,ta,(va,da)=>{Ya(va,{get user(){return S(da)}})}),e(C,Q)};u(W,C=>{r.results.users.data.content.length==0?C(V):C(aa,!1)})}e(N,B)};u(E,N=>{r.results.users.data!==null&&N(J)},F)}};u(f,E=>{r.results.users.error!==null?E(H):E(L,!1)},b)}};u(o,f=>{r.results.users===null?f(I):f(A,!1)},y)}};u(D,o=>{r.loading?o(k):o(Y,!1)})}e(P,_)};u(g,P=>{d().value==="food"?P(U):P(z,!1)},j)}};u(p,g=>{d().value==="restaurant"?g(O):g(x,!1)})}t(i),G(()=>{var g;return T(R,`Search on yami for ${(g=d().name)!=null?g:""}`)}),e(n,i),oa(),m()}var Ir=l('<h2 class="text-center text-lg p-4">You must be logged in to have a feed!</h2> <h3 class="text-center text-md p-4"><a class="underline" href="/account/login">Login</a> or <a class="underline" href="/account/register">Create an account</a></h3>',1),Fr=l("<p>It seems you don not have a feed yet! Try checking out some popular restaurants, or searching for your friends' accounts.</p>");function le(n,a){sa(a,!0);const[v,m]=ga(),d=()=>ma(ba,"$currentUserStore",v);let r=ia("loading");ya(()=>{var p;X(r,(p=Oa.url.searchParams.get("context"))!=null?p:"feed",!0)});var i=K(),h=M(i);{var c=p=>{var O=K(),x=M(O);{var g=U=>{var z=Ir();Ia(2),e(U,z)},j=U=>{var z=K(),P=M(z);{var _=k=>{var Y=Fr();e(k,Y)},D=k=>{nr(k,{get content(){return a.data.feedEntries},className:""})};u(P,k=>{a.data.feedEntries.length==0?k(_):k(D,!1)})}e(U,z)};u(x,U=>{d().data===null?U(g):U(j,!1)})}e(p,O)},R=(p,O)=>{{var x=g=>{Dr(g,{})};u(p,g=>{S(r)==="search"&&g(x)},O)}};u(h,p=>{S(r)==="feed"?p(c):p(R,!1)})}e(n,i),oa(),m()}export{le as component,oe as universal};
