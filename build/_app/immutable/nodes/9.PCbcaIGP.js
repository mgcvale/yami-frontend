var f=(t,o,i)=>new Promise((s,r)=>{var c=e=>{try{a(i.next(e))}catch(l){r(l)}},n=e=>{try{a(i.throw(e))}catch(l){r(l)}},a=e=>e.done?s(e.value):Promise.resolve(e.value).then(c,n);a((i=i.apply(t,o)).next())});import{e as h,f as v,c as u,s as y,a as _}from"../chunks/tpmtnrJv.js";import{g as b}from"../chunks/BsEKk5dv.js";import{c as x}from"../chunks/BWmCwwzs.js";import{a as E}from"../chunks/C8egYXTT.js";import{D as S}from"../chunks/D4ODo2ld.js";import{h as w}from"../chunks/Dx98FtbP.js";import{i as T}from"../chunks/N6ixcPMQ.js";import{e as p}from"../chunks/C3_eTjx-.js";import{g as D}from"../chunks/QXgKwo3K.js";import"../chunks/COm6N4YE.js";import{o as O}from"../chunks/CQT1G1Sl.js";import{p as P,h as d,a as g,b as m,c as R,f as A,g as U}from"../chunks/FcNz6uVe.js";import{i as L}from"../chunks/7ms9Oyq9.js";import{n as j}from"../chunks/DUEo-2bu.js";function k(t){return f(this,null,function*(){var s;const o=(s=b(x).data)==null?void 0:s.accessToken,i={};o&&(i.Authorization=`Bearer ${o}`);try{const r=yield h(yield v(u.apiPaths.user(t),{headers:i},u.fetchTimeout));return console.log(r),E(r)?_(r):y(S.BAD_RESPONSE)}catch(r){return w(r)}})}function B(t){return!(typeof t!="object"||t===null||typeof t.averageRating!="number"||!T(t.ratingDistribution))}function z(t){return f(this,null,function*(){try{const o=yield h(yield v(u.apiPaths.userStats(t),{},u.fetchTimeout));return B(o)?_(o):y(S.BAD_RESPONSE)}catch(o){return w(o)}})}const I=t=>f(null,null,function*(){const{parent:o,depends:i}=t,{user:s}=yield o(),r=t.url.searchParams.get("id");!r&&!s&&D("/account/login");const c=r?parseInt(r):s.id;console.log(c);const n=!r||s&&c===s.id;let a;if(n?a={data:s,error:null}:a=yield k(c),a.error)throw p(a.error.status,a.error);const e=yield z(c);if(e.error)throw p(e.error.status,e.error);return{user:a.data,stats:e.data,userId:c,viewingSelf:n}}),tt=Object.freeze(Object.defineProperty({__proto__:null,load:I},Symbol.toStringTag,{value:"Module"}));var M=A('<div class="flex flex-col py-4 pt-6 px-2 gap-3 text-center"><h2 class="w-full text-center text-xl">Loading...</h2></div>');function rt(t,o){P(o,!0),O(()=>{console.log("LOADED LAYOUT")});var i=d(),s=g(i);{var r=n=>{var a=M();m(n,a)},c=n=>{var a=d(),e=g(a);U(e,()=>o.children),m(n,a)};L(s,n=>{j.to?n(r):n(c,!1)})}m(t,i),R()}export{rt as component,tt as universal};
